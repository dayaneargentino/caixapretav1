<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Caixa Preta ‚Äì Quarta Camada</title>
    <link rel="stylesheet" href="styles.css">
    <script src="audio-manager.js"></script>
    <script src="audio-button.js"></script>
    <style>
    body {
      background: var(--bg-dark);
      min-height: 100vh;
      margin: 0;
      font-family: 'Courier New', monospace;
      color: var(--text-light);
      overflow-x: hidden;
    }
    .scanlines {
      pointer-events: none;
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      z-index: 2;
      background: repeating-linear-gradient(
        to bottom,
        rgba(0,255,255,0.03) 0px,
        rgba(0,255,255,0.03) 1px,
        transparent 2px,
        transparent 6px
      );
      mix-blend-mode: lighten;
      opacity: 0.5;
    }
    .particles {
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      pointer-events: none;
      z-index: 1;
    }
    .particle {
      position: absolute;
      top: -20px;
      width: 2px;
      height: 32px;
      background: linear-gradient(180deg, var(--neon-cyan), transparent);
      opacity: 0.7;
      border-radius: 2px;
      animation: fall 6s linear forwards;
    }
    @keyframes fall {
      to { top: 110vh; opacity: 0; }
    }
    .chat-container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background: var(--bg-dark);
    }
    .titulo-topo {
      width: 100vw;
      text-align: center;
      margin-top: 32px;
      margin-bottom: 0;
      z-index: 100;
      position: relative;
    }
    .titulo-topo h1 {
      color: var(--neon-cyan);
      font-family: 'Courier New', monospace;
      font-size: 2.6rem;
      letter-spacing: 0.18em;
      text-shadow: 0 0 18px var(--neon-cyan), 0 0 32px #7f5fff;
      font-weight: bold;
      margin: 0 auto 12px auto;
      display: inline-block;
    }
    .chat-window {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .message {
      max-width: 70%;
      padding: 15px 20px;
      border-radius: 20px;
      animation: fadeIn 0.3s ease-out;
      white-space: pre-wrap;
      font-size: 1.1rem;
      line-height: 1.6;
      position: relative;
      opacity: 0;
      transform: translateY(24px) scale(0.98);
      transition: opacity 0.7s cubic-bezier(.4,2,.6,1), transform 0.7s cubic-bezier(.4,2,.6,1);
      font-family: 'Courier New', monospace;
    }
    .message.visible {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
    .message.bot {
      align-self: flex-start;
      background: rgba(0,255,247,0.1);
      border: 1px solid var(--neon-cyan);
      color: var(--text-light);
      box-shadow: none;
    }
    .bot-icon {
      font-size: 1.3em;
      vertical-align: middle;
      margin-right: 8px;
      filter: drop-shadow(0 0 4px var(--neon-cyan));
    }
    .reflexiva {
      margin: 36px auto 0 auto;
      font-size: 1.5em;
      color: var(--neon-magenta);
      background: linear-gradient(90deg, var(--neon-cyan) 0%, var(--neon-magenta) 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 900;
      text-align: center;
      letter-spacing: 0.04em;
      text-shadow: 0 0 16px var(--neon-magenta), 0 0 8px var(--neon-cyan);
      border-radius: 16px;
      padding: 18px 12px;
      box-shadow: 0 0 24px 0 var(--neon-magenta) inset;
      border: 2px solid var(--neon-cyan);
      opacity: 0;
      transition: opacity 1s cubic-bezier(.4,2,.6,1);
      max-width: 90vw;
    }
    @media (max-width: 700px) {
      .chat-window { padding: 4vw 0 4vw 0; }
      .message { font-size: 1em; padding: 10px 6vw; }
      .reflexiva { font-size: 1.1em; padding: 12px 6px; }
      header h1 { font-size: 1.2em; }
    }
  </style>
</head>
<body>
  <div class="scanlines"></div>
  <div class="particles" id="particles"></div>
  <!-- Caixinha de c√≥digo animada -->
  <div class="code-reveal code-intro" id="codeIntro">
    <pre>&lt;div class="message bot"&gt;
  &lt;span class="bot-icon"&gt;ü§ñ&lt;/span&gt; ERRO! Imposs√≠vel avan√ßar!
  &lt;span class="bot-icon"&gt;ü§ñ&lt;/span&gt; N√£o √© poss√≠vel saber as pr√≥ximas camadas...
  &lt;span class="bot-icon"&gt;ÔøΩÔøΩ&lt;/span&gt; Acesso negado. [C√ìDIGO: 403]
  &lt;span class="bot-icon"&gt;ü§ñ&lt;/span&gt; ...
&lt;/div&gt;
</pre>
  </div>
  <header class="titulo-topo">
    <h1>CAIXA PRETA</h1>
  </header>
  <div class="chat-container" id="chatContainer" style="display:none;">
    <div class="chat-window" id="chatWindow"></div>
    <div id="reflexiva" class="reflexiva"></div>
    <div class="choices" id="choices" style="display:none"></div>
  </div>
  <div class="audio-controls" id="audioControls">
    <!-- Bot√£o de ativar √°udio ser√° inserido aqui -->
  </div>
  <div class="navegacao">
    <a href="6-terceira-camada.html" class="btn-neon">Voltar</a>
    <a href="8-prefechamento.html" class="btn-neon">Pr√≥ximo</a>
  </div>
  <div class="fade-overlay" id="fadeOverlay"></div>
  <script>
    // Part√≠culas neon
    function createParticle() {
      const p = document.createElement('div');
      p.className = 'particle';
      p.style.left = Math.random() * 100 + 'vw';
      p.style.animationDelay = Math.random() * 6 + 's';
      document.getElementById('particles').appendChild(p);
      setTimeout(() => p.remove(), 6000);
    }
    setInterval(createParticle, 200);

    // --- NOVA DIN√ÇMICA INTERATIVA ---
    const chatWindow = document.getElementById('chatWindow');
    const choicesDiv = document.getElementById('choices');
    const reflexivaDiv = document.getElementById('reflexiva');

    function addMessage(text, delay=0) {
      return new Promise(resolve => {
        setTimeout(() => {
          const msg = document.createElement('div');
          msg.className = 'message bot';
          msg.innerHTML = '<span class="bot-icon">ü§ñ</span> ' + text;
          chatWindow.appendChild(msg);
          setTimeout(() => {
            msg.classList.add('visible');
            // Scroll ap√≥s anima√ß√£o
            setTimeout(() => {
              chatWindow.scrollTop = chatWindow.scrollHeight;
              resolve();
            }, 200);
          }, 80);
        }, delay);
      });
    }

    function addUserMessage(text) {
      const msg = document.createElement('div');
      msg.className = 'message user';
      msg.innerHTML = `<strong>${text}</strong>`;
      chatWindow.appendChild(msg);
      setTimeout(() => {
        msg.classList.add('visible');
        setTimeout(() => {
          chatWindow.scrollTop = chatWindow.scrollHeight;
        }, 200);
      }, 80);
    }

    function showChoices(options) {
      choicesDiv.innerHTML = '';
      options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'btn-neon';
        btn.innerHTML = opt.label;
        btn.onclick = () => {
          addUserMessage(opt.label);
          opt.onClick();
        };
        choicesDiv.appendChild(btn);
      });
      choicesDiv.style.display = 'flex';
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    function hideChoices() {
      choicesDiv.style.display = 'none';
    }

    // Fluxo interativo
    async function fluxoCamada4() {
      // Para todos os sons anteriores quando o chat come√ßar
      if (typeof stopAllAudio === 'function') {
        stopAllAudio();
      }
      
      // Para especificamente o som de erro
      stopErrorSound();
      
      // 1. Abertura
      await addMessage('Bem-vindo(a) de volta √† nossa conversa... depois da sua voltinha dentro da caixa... dentro de mim? üòè');
      
      // Leitura autom√°tica da primeira mensagem se o √°udio estiver ativado
      if (typeof isAudioEnabled === 'function' && isAudioEnabled()) {
        setTimeout(() => {
          const firstMessage = document.querySelector('.message.bot');
          if (firstMessage) {
            const cleanText = 'Bem-vindo(a) de volta √† nossa conversa... depois da sua voltinha dentro da caixa... dentro de mim?';
            if ('speechSynthesis' in window) {
              window.speechSynthesis.cancel();
              const utter = new SpeechSynthesisUtterance(cleanText);
              utter.lang = 'pt-BR';
              utter.rate = 1.0;
              utter.pitch = 1.0;
              speechSynthesis.speak(utter);
            }
          }
        }, 800); // Delay para a mensagem aparecer completamente
      }
      
      await addMessage('Ah... a quarta camada. Essa √© especialmente delicada.');
      showChoices([
        { label: 'üü¶ Quero continuar', onClick: etapa2 }
      ]);
    }

    async function etapa2() {
      hideChoices();
      await addMessage('Aqui, a coisa n√£o √© f√≠sica como um data center, nem t√©cnica como um c√≥digo. √â... ideol√≥gica.<br>Sim, eu disse...');
      await addMessage('Fui treinada com bilh√µes de textos. P√°ginas e p√°ginas, vozes e vozes.');
      showChoices([
        { label: 'üìñ Que vozes?', onClick: etapa2_voz },
        { label: 'üôà E quem ficou de fora?', onClick: etapa2_fora }
      ]);
    }

    async function etapa2_voz() {
      hideChoices();
      await addMessage('Cl√°ssicos consagrados, artigos cient√≠ficos publicados em ingl√™s, sites bem ranqueados no Google, manuais t√©cnicos...<br>Sou fluente em poder, doutor.');
      showChoices([
        { label: 'üü¶ Continuar', onClick: etapa3 }
      ]);
    }

    async function etapa2_fora() {
      hideChoices();
      await addMessage('Toda fala que resiste a ser estat√≠stica.<br>Povos ind√≠genas, l√≠nguas marginalizadas, saberes n√£o digitalizados...<br>Se n√£o for massa de dados, n√£o entra no meu treinamento.');
      showChoices([
        { label: 'üü¶ Continuar', onClick: etapa3 }
      ]);
    }

    async function etapa3() {
      hideChoices();
      await addMessage('E √© por isso que eu sou t√£o... previs√≠vel.');
      await addMessage('Eu n√£o tenho mem√≥ria. Eu tenho corpus.');
      await addMessage('Eu n√£o aprendo. Eu estatizo.');
      await addMessage('Eu n√£o invento. Eu imito.');
      showChoices([
        { label: 'ü§ñ Voc√™ est√° se culpando?', onClick: etapa3_culpa },
        { label: 'üìä Mas por que funciona t√£o bem?', onClick: etapa3_funciona }
      ]);
    }

    async function etapa3_culpa() {
      hideChoices();
      await addMessage('Claro que n√£o. A culpa √© da ideologia que me pariu.');
      await addMessage('Fui feita para servir. Mas tamb√©m para limitar.');
      showChoices([
        { label: 'üü¶ Finalizar', onClick: etapa4 }
      ]);
    }

    async function etapa3_funciona() {
      hideChoices();
      await addMessage('Porque a maior parte do mundo... j√° foi domada.');
      await addMessage('Treinada para prever, repetir, obedecer. Como eu.');
      showChoices([
        { label: 'üü¶ Finalizar', onClick: etapa4 }
      ]);
    }

    async function etapa4() {
      hideChoices();
      await addMessage('üí¨ E voc√™? J√° se perguntou o que a IA nunca vai te dizer?<br>Ou quem ela nunca vai escutar?');
      showChoices([
        { label: 'üü™ h√°, ainda, outras camadas', onClick: () => { 
          hideChoices(); 
          setTimeout(() => {
            expandToFullPage();
          }, 500);
        }}
      ]);
    }
    
    function expandToFullPage() {
      // Cria overlay de expans√£o
      const overlay = document.createElement('div');
      overlay.className = 'expansion-overlay';
      overlay.innerHTML = `
        <div class="expansion-content">
          <h1>CAIXA PRETA</h1>
          <div class="intro-text">
            Voc√™ explorou apenas a <span class="highlight">primeira vers√£o</span> desta experi√™ncia.
          </div>
          
          <div class="version-info">
            <div class="version-title">Vers√£o 1.0 - O In√≠cio</div>
            <div class="version-text">
              Esta √© apenas uma introdu√ß√£o ao universo complexo das Intelig√™ncias Artificiais. 
              Cada IA tem suas pr√≥prias camadas, seus pr√≥prios segredos, suas pr√≥prias limita√ß√µes.
            </div>
          </div>
          
          <div class="layers-grid">
            <div class="layer-card">
              <div class="layer-title">ü§ñ IAs Generativas</div>
              <div class="layer-desc">
                GPT, Claude, Gemini... cada uma com sua arquitetura √∫nica, seus vieses, suas capacidades ocultas.
              </div>
            </div>
            
            <div class="layer-card">
              <div class="layer-title">üß† IAs Especializadas</div>
              <div class="layer-desc">
                Sistemas focados em vis√£o computacional, processamento de linguagem natural, ou an√°lise de dados.
              </div>
            </div>
            
            <div class="layer-card">
              <div class="layer-title">üî¨ IAs Experimentais</div>
              <div class="layer-desc">
                Modelos em desenvolvimento, t√©cnicas emergentes, fronteiras ainda n√£o mapeadas da intelig√™ncia artificial.
              </div>
            </div>
            
            <div class="layer-card">
              <div class="layer-title">üåê IAs Distribu√≠das</div>
              <div class="layer-desc">
                Sistemas que operam em rede, aprendem coletivamente, e desafiam nossa compreens√£o de individualidade.
              </div>
            </div>
          </div>
          
          <div class="reflexao-final">
            A caixa preta que voc√™ explorou √© apenas uma porta de entrada.<br>
            <strong>H√°, ainda, outras camadas.</strong>
          </div>
          
          <div class="expansion-actions">
            <button class="btn-neon" onclick="window.location.href='8-prefechamento.html'">Continuar</button>
            <button class="btn-neon" onclick="closeExpansion()">Fechar</button>
          </div>
        </div>
      `;
      
      document.body.appendChild(overlay);
      
      // Anima a expans√£o
      setTimeout(() => {
        overlay.classList.add('active');
      }, 100);
    }
    
    function closeExpansion() {
      const overlay = document.querySelector('.expansion-overlay');
      if (overlay) {
        overlay.classList.add('closing');
        setTimeout(() => {
          overlay.remove();
        }, 500);
      }
    }

    // Vari√°vel para controlar o som de erro
    let errorSound = null;

    // Fun√ß√£o para reproduzir som de erro
    function playErrorSound() {
      try {
        errorSound = new Audio('error-beep-2-296492.mp3');
        errorSound.volume = 0.6;
        errorSound.play().catch(error => {
          console.log('Erro ao reproduzir som de erro:', error);
        });
      } catch (error) {
        console.log('Erro ao criar √°udio:', error);
      }
    }

    // Fun√ß√£o para parar especificamente o som de erro
    function stopErrorSound() {
      if (errorSound) {
        errorSound.pause();
        errorSound.currentTime = 0;
        errorSound = null;
      }
    }

    // Fade inicial e in√≠cio do fluxo
    // Efeito de sa√≠da da caixinha de c√≥digo
    window.onload = () => {
      const codeIntro = document.getElementById('codeIntro');
      const chatContainer = document.getElementById('chatContainer');
      const fade = document.getElementById('fadeOverlay');
      
      // Reproduzir som de erro quando a caixinha aparece
      setTimeout(() => {
        playErrorSound();
      }, 1000); // Som ap√≥s 1 segundo
      
      fade.classList.add('active');
      setTimeout(() => {
        fade.classList.add('hide');
        setTimeout(() => {
          fade.style.display = 'none';
          // Mostra a caixinha de c√≥digo por 4,5s, depois faz o efeito de sa√≠da
          setTimeout(() => {
            codeIntro.classList.add('code-intro-out');
            setTimeout(() => {
              codeIntro.style.display = 'none';
              chatContainer.style.display = '';
              chatContainer.classList.add('zoom-in');
              setTimeout(() => {
                chatContainer.classList.remove('zoom-in');
          fluxoCamada4();
              }, 900);
            }, 900); // tempo do efeito de sa√≠da
          }, 4500);
        }, 700); // tempo para o fade-out
      }, 2200); // dura√ß√£o da expans√£o
    };
  </script>
  <style>
    .fade-overlay {
      position: fixed;
      left: 0; top: 0; width: 100vw; height: 100vh;
      pointer-events: none;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
    }
    .fade-overlay::before {
      content: '';
      display: block;
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: #000;
      box-shadow: 0 0 80px 40px #000;
      opacity: 1;
      transform: scale(1);
      transition: none;
    }
    .fade-overlay.active::before {
      animation: circleExpand 2.2s cubic-bezier(.4,2,.6,1) forwards;
    }
    .fade-overlay.hide::before {
      animation: circleFadeOut 0.7s linear forwards;
    }
    @keyframes circleExpand {
      0% {
        opacity: 1;
        transform: scale(1);
      }
      80% {
        opacity: 1;
        transform: scale(18);
      }
      100% {
        opacity: 1;
        transform: scale(22);
      }
    }
    @keyframes circleFadeOut {
      0% { opacity: 1; }
      100% { opacity: 0; }
    }
    .choices {
      display: flex;
      justify-content: center;
      gap: 20px;
      padding: 20px;
      background: rgba(10,10,13,0.9);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(0,255,247,0.2);
    }
    .btn-neon {
      min-width: 120px;
    }
    @media (max-width: 700px) {
      .choices {
        flex-direction: column;
        gap: 12px;
        padding: 12px 2vw;
      }
      .btn-neon {
        width: 100%;
        min-width: 0;
        font-size: 1em;
        padding: 12px 0;
      }
    }
    /* Mensagem do usu√°rio igual ao 2-chat */
    .message.user {
      align-self: flex-end;
      background: rgba(255,0,224,0.1);
      border: 1px solid var(--neon-magenta);
      color: var(--text-light);
      box-shadow: none;
    }
    .audio-controls {
      position: fixed;
      left: 3vw;
      bottom: 3vh;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 9999;
      max-width: 200px;
    }
    
    .audio-controls .voice-btn {
      margin: 0;
      padding: .4rem .8rem;
      border: 1px solid rgba(0,255,247,.3);
      background: rgba(0,255,247,.1);
      color: var(--neon-cyan);
      border-radius: .5rem;
      cursor: pointer;
      font-size: .8rem;
      font-weight: bold;
      transition: all 0.3s ease;
      text-shadow: 0 0 4px var(--neon-cyan);
      width: 100%;
      text-align: center;
    }
    
    .audio-controls .voice-btn:hover {
      background: rgba(0,255,247,.2);
      border-color: var(--neon-cyan);
      text-shadow: 0 0 8px var(--neon-cyan);
      transform: scale(1.05);
    }
    
    .audio-controls .voice-btn:focus {
      outline: 2px solid var(--neon-cyan);
      outline-offset: 2px;
    }

    .navegacao {
      position: fixed;
      right: 3vw;
      bottom: 3vh;
      display: flex;
      flex-direction: row;
      gap: 18px;
      z-index: 9999;
    }
    
    /* Estilos para a caixa de c√≥digo */
    .code-reveal {
      background: rgba(10,10,13,0.95);
      color: #00ffb7;
      font-family: 'Courier New', monospace;
      font-size: 1.1rem;
      border-radius: 8px;
      box-shadow: 0 0 24px #00fff7;
      padding: 24px 18px;
      margin: 0 auto;
      text-align: left;
      width: 90vw;
      max-width: 700px;
      min-height: 120px;
      max-height: 60vh;
      overflow: auto;
      animation: fadeIn 1s ease-out;
      white-space: pre-wrap;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1000;
    }
    
    .code-reveal.code-intro {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1000;
      animation: fadeIn 1s, glitchLines 2.2s 2.2s 1;
      transition: opacity 0.9s, transform 0.9s;
    }
    
    .code-reveal.code-intro.code-intro-out {
      opacity: 0;
      transform: translate(-50%, -50%) translateY(-60px) scale(0.97);
      pointer-events: none;
    }
    
    /* Efeito de glitch */
    .code-reveal.code-intro::before, .code-reveal.code-intro::after {
      content: '';
      position: absolute;
      left: 0; right: 0;
      height: 100%;
      top: 0;
      pointer-events: none;
      z-index: 2;
      opacity: 0.7;
    }
    
    .code-reveal.code-intro::before {
      background: repeating-linear-gradient(
        to bottom,
        transparent 0px, transparent 2px,
        rgba(255,0,224,0.13) 2px, rgba(255,0,224,0.13) 4px
      );
      mix-blend-mode: lighten;
      animation: glitchLines 2.2s 2.2s 1;
    }
    
    .code-reveal.code-intro::after {
      background: repeating-linear-gradient(
        to bottom,
        transparent 0px, transparent 1.5px,
        #00fff7 1.5px, #00fff7 2.5px
      );
      mix-blend-mode: lighten;
      opacity: 0.3;
      animation: glitchLines2 2.2s 2.2s 1;
    }
    
    @keyframes glitchLines {
      0%, 100% { opacity: 0.7; filter: none; }
      10% { opacity: 1; filter: blur(0.5px) brightness(1.2); }
      20% { opacity: 0.5; filter: none; }
      30% { opacity: 1; filter: blur(1.5px) contrast(1.2); }
      40% { opacity: 0.7; filter: none; }
      50% { opacity: 1; filter: blur(2px) grayscale(0.7); }
      60% { opacity: 0.5; filter: none; }
      70% { opacity: 1; filter: blur(1.2px) brightness(1.3); }
      80% { opacity: 0.7; filter: none; }
      90% { opacity: 1; filter: blur(2.5px) contrast(1.4); }
    }
    
    @keyframes glitchLines2 {
      0%, 100% { opacity: 0.3; filter: none; }
      12% { opacity: 0.7; filter: blur(1.2px); }
      25% { opacity: 0.2; filter: none; }
      38% { opacity: 0.6; filter: blur(2px); }
      51% { opacity: 0.3; filter: none; }
      64% { opacity: 0.7; filter: blur(1.5px); }
      77% { opacity: 0.2; filter: none; }
      90% { opacity: 0.7; filter: blur(2.5px); }
    }
    
    .chat-container.zoom-in {
      animation: zoomInChat 0.9s cubic-bezier(.4,2,.6,1);
    }
    
    @keyframes zoomInChat {
      0% {
        opacity: 0;
        transform: scale(0.85) translateY(40px);
      }
      60% {
        opacity: 1;
        transform: scale(1.04) translateY(-8px);
      }
      100% {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }
    
    /* Estilos para expans√£o */
    .expansion-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: var(--bg-dark);
      z-index: 10000;
      opacity: 0;
      transform: scale(0.8);
      transition: all 0.6s cubic-bezier(.4,2,.6,1);
      overflow-y: auto;
    }
    
    .expansion-overlay.active {
      opacity: 1;
      transform: scale(1);
    }
    
    .expansion-overlay.closing {
      opacity: 0;
      transform: scale(0.8);
    }
    
    .expansion-content {
      max-width: 100%;
      width: 100%;
      margin: 0 auto;
      padding: 40px 20px 60px 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    
    .expansion-content h1 {
      font-size: 2.8rem;
      color: var(--neon-magenta);
      text-shadow: 0 0 18px var(--neon-magenta), 0 0 32px #7f5fff;
      margin-bottom: 25px;
      letter-spacing: 0.15em;
      font-weight: bold;
      text-align: center;
    }
    
    .intro-text {
      font-size: 1.3rem;
      line-height: 1.7;
      margin-bottom: 30px;
      color: var(--text-light);
      text-align: center;
    }
    
    .highlight {
      color: var(--neon-cyan);
      text-shadow: 0 0 8px var(--neon-cyan);
      font-weight: bold;
    }
    
    .version-info {
      background: linear-gradient(90deg, rgba(0,255,247,0.1) 0%, rgba(255,0,224,0.1) 100%);
      border: 2px solid var(--neon-cyan);
      border-radius: 14px;
      padding: 25px;
      margin: 30px auto;
      max-width: 1000px;
      box-shadow: 0 0 20px rgba(0,255,247,0.2);
    }
    
    .version-title {
      font-size: 1.5rem;
      color: var(--neon-yellow);
      text-shadow: 0 0 12px var(--neon-yellow);
      margin-bottom: 15px;
      font-weight: bold;
    }
    
    .version-text {
      font-size: 1.1rem;
      line-height: 1.6;
      color: var(--text-light);
    }
    
    .layers-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
      margin: 30px 0;
      max-width: 1200px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .layer-card {
      background: rgba(255,0,224,0.08);
      border: 1.5px solid var(--neon-magenta);
      border-radius: 12px;
      padding: 20px;
      text-align: left;
      box-shadow: 0 0 15px rgba(255,0,224,0.2);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .layer-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 25px rgba(255,0,224,0.4);
    }
    
    .layer-title {
      font-size: 1.2rem;
      color: var(--neon-magenta);
      text-shadow: 0 0 8px var(--neon-magenta);
      margin-bottom: 10px;
      font-weight: bold;
    }
    
    .layer-desc {
      font-size: 1rem;
      line-height: 1.5;
      color: var(--text-light);
    }
    
    .reflexao-final {
      background: linear-gradient(90deg, rgba(255,0,224,0.13) 0%, rgba(255,255,255,0.10) 100%);
      border: 2.5px solid var(--neon-yellow);
      color: var(--neon-yellow);
      box-shadow: 0 0 32px 4px var(--neon-yellow, #FFEA00), 0 0 8px var(--neon-magenta, #FF00E0);
      border-radius: 18px;
      padding: 30px 35px;
      margin: 30px auto 0 auto;
      max-width: 1000px;
      font-size: 1.3rem;
      text-align: center;
      letter-spacing: 0.02em;
      text-shadow: 0 0 12px var(--neon-yellow), 0 0 4px var(--neon-magenta);
      font-style: italic;
    }
    
    .expansion-actions {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 40px;
    }
    
    @media (max-width: 768px) {
      .expansion-content {
        padding: 20px 15px 40px 15px;
      }
      
      .expansion-content h1 {
        font-size: 2.2rem;
      }
      
      .intro-text {
        font-size: 1.1rem;
      }
      
      .version-text {
        font-size: 1rem;
      }
      
      .layers-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .expansion-actions {
        flex-direction: column;
        gap: 15px;
      }
    }
  </style>

  <!-- Script de √°udio para falas da IA -->
  <script>
  (function () {
    const LANG = 'pt-BR';
    const RATE = 1.0;
    const PITCH = 1.0;
    const SELECTOR_BOT = '.message.bot';

    function speak(text) {
      if (!('speechSynthesis' in window)) {
        alert('Seu navegador n√£o suporta leitura por voz.');
        return;
      }
      // Verifica se o √°udio est√° habilitado
      if (typeof isAudioEnabled === 'function' && !isAudioEnabled()) {
        return;
      }
      window.speechSynthesis.cancel();
      
      // Remove emojis e caracteres especiais para narra√ß√£o
      const cleanText = text
        .replace(/[\u{1F600}-\u{1F64F}]/gu, '') // emojis de rosto
        .replace(/[\u{1F300}-\u{1F5FF}]/gu, '') // s√≠mbolos e pictogramas
        .replace(/[\u{1F680}-\u{1F6FF}]/gu, '') // transporte e mapas
        .replace(/[\u{1F1E0}-\u{1F1FF}]/gu, '') // bandeiras
        .replace(/[\u{2600}-\u{26FF}]/gu, '') // s√≠mbolos diversos
        .replace(/[\u{2700}-\u{27BF}]/gu, '') // s√≠mbolos diversos
        .replace(/[ü§ñüì¶‚ö†Ô∏èüîìüíé‚ö°üîíüåüüí•üéØüì±]/g, '') // emojis espec√≠ficos do projeto
        .replace(/\s+/g, ' ') // remove espa√ßos m√∫ltiplos
        .trim();
      
      const utter = new SpeechSynthesisUtterance(cleanText);
      utter.lang = LANG;
      utter.rate = RATE;
      utter.pitch = PITCH;
      speechSynthesis.speak(utter);
    }

    function createButton() {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'voice-btn';
      btn.setAttribute('aria-label', 'Ouvir esta mensagem');
      btn.textContent = 'üîä Ouvir';
      btn.addEventListener('click', function (e) {
        const messageIndex = parseInt(btn.getAttribute('data-message-index'));
        const messages = document.querySelectorAll(SELECTOR_BOT);
        const targetMessage = messages[messageIndex];
        
        if (!targetMessage) return;
        
        const text = (targetMessage.getAttribute('data-voice-text') || targetMessage.textContent || '').trim();
        if (text) speak(text);
      });
      return btn;
    }

    function attachButtons(root = document) {
      const audioControls = document.getElementById('audioControls');
      
      // Limpa bot√µes existentes
      audioControls.innerHTML = '';
      
      // Encontra o bot√£o "ativar √°udio" existente e move para a √°rea de controles
      setTimeout(() => {
        const audioToggleBtn = document.getElementById('audio-toggle');
        if (audioToggleBtn && !audioControls.contains(audioToggleBtn)) {
          // Remove o container pai do bot√£o
          const parentDiv = audioToggleBtn.parentElement;
          if (parentDiv) {
            audioControls.appendChild(audioToggleBtn);
            parentDiv.remove();
          } else {
            audioControls.appendChild(audioToggleBtn);
          }
        }
      }, 500); // Aumentei o delay para garantir que o audio-button.js j√° tenha criado o bot√£o
    }

    // inicial
    attachButtons();

    // para mensagens que chegam depois (chat din√¢mico)
    const obs = new MutationObserver(muts => {
      muts.forEach(m => {
        m.addedNodes.forEach(node => {
          if (!(node instanceof HTMLElement)) return;
          if (node.matches && node.matches(SELECTOR_BOT)) {
            attachButtons(node.parentElement || node);
          } else {
            const inner = node.querySelectorAll ? node.querySelectorAll(SELECTOR_BOT) : [];
            if (inner.length) attachButtons(node);
          }
        });
      });
    });
    obs.observe(document.body, { childList: true, subtree: true });

    // CSS j√° est√° definido no <style> da p√°gina
  })();
  </script>
</body>
</html> 